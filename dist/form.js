const u={fname:"",lname:"",mname:"",dob:"",ssn:"",address:"",city:"",state:"",zip:"",email:"",marital:"",residency:"",employed:"",sex:"",disabled:"",numinhouse:"",EmerContactName:"",EmerContactPhone1:""},L={patwages:"",patdisab:"",patunemploy:""},h={fname:"",mname:"",lname:"",email:"",phone:"",fax:"",address:"",city:"",state:"",zip:""},q=document.querySelector('[cd="submit-data"]');let x=0,S="";const k="https://www.medserviceswebpap.com/api/patient/createpatient",A="https://www.medserviceswebpap.com/api/physician/createphysician",B="https://www.medserviceswebpap.com/auth/token?hcpid=89",$={grant_type:"password",username:"apiuser",password:"123456"};async function T(e,t){const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(t).toString()});if(!n.ok)throw new Error(n.statusText);return n.json()}async function _(e,t){try{const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(t)});if(!n.ok)throw new Error("Network response was not ok");await n.json()}catch(n){console.log(n)}}async function z(e,t){try{const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(t)});if(!n.ok)throw new Error("Network response was not ok");x=(await n.json()).Id}catch(n){console.log(n)}}async function C(e,t){try{if(!(await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(t)})).ok)throw new Error("Network response was not ok")}catch(n){console.log(n)}}q.addEventListener("click",()=>{patientAddress&&patientAddress.forEach(e=>{switch(e.types[0]){case"street_number":{u.address=`${e.long_name} `;break}case"route":{u.address+=e.short_name;break}case"locality":u.city=e.long_name;break;case"administrative_area_level_1":{u.state=e.short_name;break}}}),doctorAddress&&doctorAddress.forEach(e=>{switch(e.types[0]){case"street_number":{h.address=`${e.long_name} `;break}case"route":{h.address+=e.short_name;break}case"locality":h.city=e.long_name;break;case"administrative_area_level_1":{h.state=e.short_name;break}}}),all_data.forEach(e=>{if(e.field==="patwages"||e.field==="patdisab"||e.field==="patunemploy"){L[e.field]=e.value;return}if(e.field.includes("doc-")){let t=e.field.split("-")[1];h[t]=e.value;return}if(e.field==="month"){u.dob=`${e.value}`;return}if(e.field==="day"||e.field==="year"){u.dob=`${u.dob}/${e.value}`;return}if(e.field==="residency"||e.field==="disabled"){u[e.field]=e.value==="Yes"?"true":"false";return}if(e.field==="ssn"){u[e.field]=e.value.replace(/-/g,"");return}u[e.field]=e.value}),T(B,$).then(e=>{S=e.access_token,z(k,u).then(()=>{let t=`https://www.medserviceswebpap.com/api/patient/updatepatientincome?patientId=${x}`;C(t,L)}),_(A,h)})});window.fsAttributes=window.fsAttributes||[];window.fsAttributes.push(["cmsload",e=>{const[t]=e;for(let n=1;n<4;n++)ne(document.getElementById(`med-name-${n}`));t.on("renderitems",n=>{console.log(n)})}]);const N=document.getElementById("year"),D=105;for(let e=D;e>0;e--){const t=document.createElement("option");t.text=`${e+1900}`,t.value=`${e+1900}`,N.add(t)}function O(e,t,n,l){let s=0;t.style.display="none";const o=e.length;e.forEach((c,r)=>{r!==s&&(c.style.display="none")}),t.addEventListener("click",()=>{s>0&&(e[s].style.display="none",s--,e[s].style.display="block"),l.forEach((c,r)=>{r!==s?c.classList.remove("current"):c.classList.add("current")}),s===0?t.style.display="none":t.style.display="block"}),n.addEventListener("click",()=>{const c=e[s].querySelectorAll("input"),r=e[s].querySelectorAll("select");if(F(c,r,s))s<o-1&&(e[s].style.display="none",s++,e[s].style.display="block"),l.forEach((i,a)=>{a!==s?i.classList.remove("current"):i.classList.add("current")}),s===0?t.style.display="none":t.style.display="block";else return})}const M=document.querySelectorAll("[cd-form = step]"),j=document.querySelector("[cd-form = button-back]"),R=document.querySelector("[cd-form = button-next]"),E=document.querySelectorAll("[cd-form=progress-indicator]");O(M,j,R,E);function F(e,t,n){let l=!0;e.forEach(i=>{i.required&&(i.value===""?(l=!1,i.nextElementSibling.classList.add("active")):i.nextElementSibling.classList.remove("active"))}),t.forEach(i=>{i.required&&(i.value===""?(l=!1,i.nextElementSibling.classList.add("active")):i.nextElementSibling.classList.remove("active"))});const s=document.querySelectorAll("input[name=sex]:checked"),o=document.querySelectorAll("input[name=residency]:checked"),c=document.querySelectorAll("input[name=disabled]:checked");if(s.length===0?(document.getElementById("sex-radio-error").classList.add("active"),l=!1):document.getElementById("sex-radio-error").classList.remove("active"),o.length===0?(document.getElementById("citizen-radio-error").classList.add("active"),l=!1):document.getElementById("citizen-radio-error").classList.remove("active"),c.length===0?(document.getElementById("disabled-radio-error").classList.add("active"),l=!1):document.getElementById("disabled-radio-error").classList.remove("active"),document.getElementById("ssn").value.length!==11?(l=!1,document.getElementById("ssn-error").classList.add("active")):document.getElementById("ssn-error").classList.remove("active"),n===1){const i=document.getElementById("email");if(!i.required)return;/\S+@\S+\.\S+/.test(i.value)?i.nextElementSibling.classList.remove("active"):(l=!1,i.nextElementSibling.classList.add("active"));const d=document.getElementById("dayphone"),m=document.getElementById("EmerContactPhone");d.value.length!==10?(l=!1,d.nextElementSibling.classList.add("active")):d.nextElementSibling.classList.remove("active"),m.value.length!==10?(l=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active");const f=document.getElementById("zip");f.value.length!==5?(l=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active")}if(n===2){const i=document.getElementById("doc-email"),a=document.getElementById("doc2-email-2");if(!i.required)return;const d=/\S+@\S+\.\S+/;d.test(i.value)?i.nextElementSibling.classList.remove("active"):(l=!1,i.nextElementSibling.classList.add("active")),a.value!==""?d.test(a.value)||(l=!1,a.nextElementSibling.classList.add("active")):a.nextElementSibling.classList.remove("active");const m=document.getElementById("doc-officephone-2"),f=document.getElementById("doc-fax"),v=document.getElementById("doc2-officephone-2"),y=document.getElementById("doc2-fax-2");m.value.length!==10?(l=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active"),f.value.length!==10?(l=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active"),v.value!==""&&(v.value.length!==10?(l=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active")),y.value!==""&&(y.value.length!==10?(l=!1,y.nextElementSibling.classList.add("active")):y.nextElementSibling.classList.remove("active"));const b=document.getElementById("doc-zip-2"),g=document.getElementById("doc2-zip-2");b.value.length!==5?(l=!1,b.nextElementSibling.classList.add("active")):b.nextElementSibling.classList.remove("active"),g.value!==""&&(g.value.length!==5?(l=!1,g.nextElementSibling.classList.add("active")):g.nextElementSibling.classList.remove("active"))}return n===4&&document.querySelectorAll(".money-field").forEach(a=>{a.value!==""?document.getElementById("income-error").classList.remove("active"):(l=!1,document.getElementById("income-error").classList.add("active"))}),l}const P=document.querySelectorAll(".phone-field"),J=document.querySelectorAll('input[placeholder="Zip code"]');P.forEach(e=>{e.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>10&&(this.value=this.value.slice(0,10))})});J.forEach(e=>{e.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>5&&(this.value=this.value.slice(0,5))})});function U(e){return e.replace(/\D/g,"").replace(/^(\d{3})(\d{2})(\d{0,4})$/,(l,s,o,c)=>c?`${s}-${o}-${c}`:o?`${s}-${o}`:s)}const H=document.getElementById("ssn");H.addEventListener("input",function(){this.value=U(this.value)});const Y=document.querySelectorAll(".money-field");Y.forEach(e=>{e.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value!==""&&(this.value="$"+this.value)})});const Z=document.querySelector(".progress-bar"),G={attributes:!0};function K(e){e.forEach(function(t){if(t.type==="attributes"&&t.attributeName==="class"){let n=Array.from(E).findIndex(l=>l.classList.contains("current"));Z.style.width=`${(n+1)/E.length*100}%`}})}let Q=new MutationObserver(K);E.forEach(e=>{Q.observe(e,G)});const V=document.querySelectorAll(".doc-content-c-tab"),X=document.querySelectorAll(".doc-content-w"),W=document.querySelectorAll(".tab-minus-icon"),ee=document.querySelectorAll(".tab-plus-icon");V.forEach(e=>{e.addEventListener("click",()=>{X.forEach(t=>{t.classList.remove("active"),t.parentElement===e&&t.classList.add("active")}),W.forEach(t=>{t.classList.remove("active"),e.querySelector(".tab-minus-icon")===t&&t.classList.add("active")}),ee.forEach(t=>{t.classList.remove("active"),e.querySelector(".tab-plus-icon")!==t&&t.classList.add("active")})})});const p=document.getElementById("medicationStep"),te=p==null?void 0:p.querySelector(".form-row-wrapper"),w=document.getElementById("addMed");w.addEventListener("click",()=>{var t,n;const e=te.cloneNode(!0);p.insertBefore(e,w.parentElement),(t=e.querySelector(".flex-grow:nth-child(1) > select"))==null||t.removeAttribute("required"),(n=e.querySelector(".flex-grow:nth-child(4) > input"))==null||n.removeAttribute("required"),e.querySelector(".flex-grow:nth-child(4) > input").value="",e.querySelector(".flex-grow:nth-child(2) > select").id=`med-name-${p.childElementCount-1}`,e.querySelector(".flex-grow:nth-child(2) > select").value="",e.querySelector(".flex-grow:nth-child(3) > select").id=`med-strength-${p.childElementCount-1}`,e.querySelector(".flex-grow:nth-child(2) > select").addEventListener("change",l=>{var i;e.querySelector(".flex-grow:nth-child(3) > select").innerHTML="";const s=l.target.value.toLocaleLowerCase().split(" ").join("-"),o=(i=document.querySelector(`[cd-name=${s}]`))==null?void 0:i.parentElement,c=o==null?void 0:o.querySelectorAll("[cd=strength]"),r=[];c==null||c.forEach(a=>{const d=a.textContent;d!==null&&r.push(d)}),I(e.querySelector(".flex-grow:nth-child(3) > select"),r)})});for(let e=1;e<4;e++){const t=document.getElementById(`med-name-${e}`),n=document.getElementById(`med-strength-${e}`);t.addEventListener("change",l=>{var i;n.innerHTML="";const s=l.target.value.toLocaleLowerCase().replace(/[\(\)\/]/g,"").split(" ").join("-"),o=(i=document.querySelector(`[cd-name=${s}]`))==null?void 0:i.parentElement;console.log(o),console.log(s);const c=o==null?void 0:o.querySelectorAll("[cd=strength]"),r=[];c==null||c.forEach(a=>{const d=a.textContent;d!==null&&r.push(d)}),I(n,r)})}function ne(e){document.querySelectorAll("[cd=drug]").forEach(n=>{const l=document.createElement("option"),s=n.textContent;s!==null&&(l.text=s,l.value=s,l.setAttribute("cd",s),e.add(l))})}function I(e,t){if(t.length>9){e.innerHTML="";const s=document.createElement("option");s.text="Select Medication First",s.value="",e.add(s);return}e.removeAttribute("disabled"),e.classList.remove("disabled"),e.innerHTML="";const n=document.createElement("option");n.text="Select Medication First",n.value="",e.add(n);let l=!0;t.forEach(s=>{if(s==="")return;l=!1;const o=document.createElement("option");o.text=s,o.value=s,e.add(o)}),l&&(e.setAttribute("disabled","true"),e.classList.add("disabled"))}
