const u={fname:"",lname:"",mname:"",dob:"",ssn:"",address:"",city:"",state:"",zip:"",email:"",marital:"",residency:"",employed:"",sex:"",disabled:"",numinhouse:"",EmerContactName:"",EmerContactPhone1:""},L={patwages:"",patdisab:"",patunemploy:""},h={fname:"",mname:"",lname:"",email:"",phone:"",fax:"",address:"",city:"",state:"",zip:""},q=document.querySelector('[cd="submit-data"]');let x=0,S="";const A="https://www.medserviceswebpap.com/api/patient/createpatient",k="https://www.medserviceswebpap.com/api/physician/createphysician",B="https://www.medserviceswebpap.com/auth/token?hcpid=89",$={grant_type:"password",username:"apiuser",password:"123456"};async function T(t,e){const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(e).toString()});if(!n.ok)throw new Error(n.statusText);return n.json()}async function _(t,e){try{const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(e)});if(!n.ok)throw new Error("Network response was not ok");await n.json()}catch(n){console.log(n)}}async function z(t,e){try{const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(e)});if(!n.ok)throw new Error("Network response was not ok");x=(await n.json()).Id}catch(n){console.log(n)}}async function C(t,e){try{if(!(await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`},body:JSON.stringify(e)})).ok)throw new Error("Network response was not ok")}catch(n){console.log(n)}}q.addEventListener("click",()=>{patientAddress&&patientAddress.forEach(e=>{switch(e.types[0]){case"street_number":{u.address=`${e.long_name} `;break}case"route":{u.address+=e.short_name;break}case"locality":u.city=e.long_name;break;case"administrative_area_level_1":{u.state=e.short_name;break}}}),doctorAddress&&doctorAddress.forEach(e=>{switch(e.types[0]){case"street_number":{h.address=`${e.long_name} `;break}case"route":{h.address+=e.short_name;break}case"locality":h.city=e.long_name;break;case"administrative_area_level_1":{h.state=e.short_name;break}}});const t=[];document.querySelectorAll(".input-field").forEach(e=>{let n=e.id,s=e.value;t.push({field:n,value:s})}),document.querySelectorAll("input[type=radio]:checked").forEach(e=>{let n=e.name,s=e.id;t.push({field:n,value:s})}),console.log(t),t.forEach(e=>{if(console.log(e),e.field==="patwages"||e.field==="patdisab"||e.field==="patunemploy"){L[e.field]=e.value.slice(1);return}if(e.field.includes("doc-")){let n=e.field.split("-")[1];h[n]=e.value;return}if(e.field==="month"){u.dob=`${e.value}`;return}if(e.field==="day"||e.field==="year"){u.dob=`${u.dob}/${e.value}`;return}if(e.field==="residency"||e.field==="disabled"){u[e.field]=e.value==="Yes"?"true":"false";return}if(e.field==="ssn"){u[e.field]=e.value.replace(/-/g,"");return}u[e.field]=e.value}),T(B,$).then(e=>{S=e.access_token,z(A,u).then(()=>{let n=`https://www.medserviceswebpap.com/api/patient/updatepatientincome?patientId=${x}`;C(n,L)}),_(k,h)})});window.fsAttributes=window.fsAttributes||[];window.fsAttributes.push(["cmsload",t=>{const[e]=t;for(let n=1;n<4;n++)ne(document.getElementById(`med-name-${n}`));e.on("renderitems",n=>{console.log(n)})}]);const N=document.getElementById("year"),D=105;for(let t=D;t>0;t--){const e=document.createElement("option");e.text=`${t+1900}`,e.value=`${t+1900}`,N.add(e)}function O(t,e,n,s){let l=0;e.style.display="none";const o=t.length;t.forEach((c,r)=>{r!==l&&(c.style.display="none")}),e.addEventListener("click",()=>{l>0&&(t[l].style.display="none",l--,t[l].style.display="block"),s.forEach((c,r)=>{r!==l?c.classList.remove("current"):c.classList.add("current")}),l===0?e.style.display="none":e.style.display="block"}),n.addEventListener("click",()=>{const c=t[l].querySelectorAll("input"),r=t[l].querySelectorAll("select");if(R(c,r,l))l<o-1&&(t[l].style.display="none",l++,t[l].style.display="block"),s.forEach((i,a)=>{a!==l?i.classList.remove("current"):i.classList.add("current")}),l===0?e.style.display="none":e.style.display="block";else return})}const M=document.querySelectorAll("[cd-form = step]"),j=document.querySelector("[cd-form = button-back]"),F=document.querySelector("[cd-form = button-next]"),E=document.querySelectorAll("[cd-form=progress-indicator]");O(M,j,F,E);function R(t,e,n){let s=!0;t.forEach(i=>{i.required&&(i.value===""?(s=!1,i.nextElementSibling.classList.add("active")):i.nextElementSibling.classList.remove("active"))}),e.forEach(i=>{i.required&&(i.value===""?(s=!1,i.nextElementSibling.classList.add("active")):i.nextElementSibling.classList.remove("active"))});const l=document.querySelectorAll("input[name=sex]:checked"),o=document.querySelectorAll("input[name=residency]:checked"),c=document.querySelectorAll("input[name=disabled]:checked");if(l.length===0?(document.getElementById("sex-radio-error").classList.add("active"),s=!1):document.getElementById("sex-radio-error").classList.remove("active"),o.length===0?(document.getElementById("citizen-radio-error").classList.add("active"),s=!1):document.getElementById("citizen-radio-error").classList.remove("active"),c.length===0?(document.getElementById("disabled-radio-error").classList.add("active"),s=!1):document.getElementById("disabled-radio-error").classList.remove("active"),document.getElementById("ssn").value.length!==11?(s=!1,document.getElementById("ssn-error").classList.add("active")):document.getElementById("ssn-error").classList.remove("active"),n===1){const i=document.getElementById("email");if(!i.required)return;/\S+@\S+\.\S+/.test(i.value)?i.nextElementSibling.classList.remove("active"):(s=!1,i.nextElementSibling.classList.add("active"));const d=document.getElementById("dayphone"),m=document.getElementById("EmerContactPhone");d.value.length!==10?(s=!1,d.nextElementSibling.classList.add("active")):d.nextElementSibling.classList.remove("active"),m.value.length!==10?(s=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active");const f=document.getElementById("zip");f.value.length!==5?(s=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active")}if(n===2){const i=document.getElementById("doc-email"),a=document.getElementById("doc2-email-2");if(!i.required)return;const d=/\S+@\S+\.\S+/;d.test(i.value)?i.nextElementSibling.classList.remove("active"):(s=!1,i.nextElementSibling.classList.add("active")),a.value!==""?d.test(a.value)||(s=!1,a.nextElementSibling.classList.add("active")):a.nextElementSibling.classList.remove("active");const m=document.getElementById("doc-officephone-2"),f=document.getElementById("doc-fax"),v=document.getElementById("doc2-officephone-2"),y=document.getElementById("doc2-fax-2");m.value.length!==10?(s=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active"),f.value.length!==10?(s=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active"),v.value!==""&&(v.value.length!==10?(s=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active")),y.value!==""&&(y.value.length!==10?(s=!1,y.nextElementSibling.classList.add("active")):y.nextElementSibling.classList.remove("active"));const b=document.getElementById("doc-zip-2"),g=document.getElementById("doc2-zip-2");b.value.length!==5?(s=!1,b.nextElementSibling.classList.add("active")):b.nextElementSibling.classList.remove("active"),g.value!==""&&(g.value.length!==5?(s=!1,g.nextElementSibling.classList.add("active")):g.nextElementSibling.classList.remove("active"))}return n===4&&document.querySelectorAll(".money-field").forEach(a=>{a.value!==""?document.getElementById("income-error").classList.remove("active"):(s=!1,document.getElementById("income-error").classList.add("active"))}),s}const P=document.querySelectorAll(".phone-field"),J=document.querySelectorAll('input[placeholder="Zip code"]');P.forEach(t=>{t.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>10&&(this.value=this.value.slice(0,10))})});J.forEach(t=>{t.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>5&&(this.value=this.value.slice(0,5))})});function U(t){return t.replace(/\D/g,"").replace(/^(\d{3})(\d{2})(\d{0,4})$/,(s,l,o,c)=>c?`${l}-${o}-${c}`:o?`${l}-${o}`:l)}const H=document.getElementById("ssn");H.addEventListener("input",function(){this.value=U(this.value)});const Y=document.querySelectorAll(".money-field");Y.forEach(t=>{t.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value!==""&&(this.value="$"+this.value)})});const Z=document.querySelector(".progress-bar"),G={attributes:!0};function K(t){t.forEach(function(e){if(e.type==="attributes"&&e.attributeName==="class"){let n=Array.from(E).findIndex(s=>s.classList.contains("current"));Z.style.width=`${(n+1)/E.length*100}%`}})}let Q=new MutationObserver(K);E.forEach(t=>{Q.observe(t,G)});const V=document.querySelectorAll(".doc-content-c-tab"),X=document.querySelectorAll(".doc-content-w"),W=document.querySelectorAll(".tab-minus-icon"),ee=document.querySelectorAll(".tab-plus-icon");V.forEach(t=>{t.addEventListener("click",()=>{X.forEach(e=>{e.classList.remove("active"),e.parentElement===t&&e.classList.add("active")}),W.forEach(e=>{e.classList.remove("active"),t.querySelector(".tab-minus-icon")===e&&e.classList.add("active")}),ee.forEach(e=>{e.classList.remove("active"),t.querySelector(".tab-plus-icon")!==e&&e.classList.add("active")})})});const p=document.getElementById("medicationStep"),te=p==null?void 0:p.querySelector(".form-row-wrapper"),w=document.getElementById("addMed");w.addEventListener("click",()=>{var e,n;const t=te.cloneNode(!0);p.insertBefore(t,w.parentElement),(e=t.querySelector(".flex-grow:nth-child(1) > select"))==null||e.removeAttribute("required"),(n=t.querySelector(".flex-grow:nth-child(4) > input"))==null||n.removeAttribute("required"),t.querySelector(".flex-grow:nth-child(4) > input").value="",t.querySelector(".flex-grow:nth-child(2) > select").id=`med-name-${p.childElementCount-1}`,t.querySelector(".flex-grow:nth-child(2) > select").value="",t.querySelector(".flex-grow:nth-child(3) > select").id=`med-strength-${p.childElementCount-1}`,t.querySelector(".flex-grow:nth-child(2) > select").addEventListener("change",s=>{var i;t.querySelector(".flex-grow:nth-child(3) > select").innerHTML="";const l=s.target.value.toLocaleLowerCase().split(" ").join("-"),o=(i=document.querySelector(`[cd-name=${l}]`))==null?void 0:i.parentElement,c=o==null?void 0:o.querySelectorAll("[cd=strength]"),r=[];c==null||c.forEach(a=>{const d=a.textContent;d!==null&&r.push(d)}),I(t.querySelector(".flex-grow:nth-child(3) > select"),r)})});for(let t=1;t<4;t++){const e=document.getElementById(`med-name-${t}`),n=document.getElementById(`med-strength-${t}`);e.addEventListener("change",s=>{var i;n.innerHTML="";const l=s.target.value.toLocaleLowerCase().replace(/[\(\)\/]/g,"").split(" ").join("-"),o=(i=document.querySelector(`[cd-name=${l}]`))==null?void 0:i.parentElement,c=o==null?void 0:o.querySelectorAll("[cd=strength]"),r=[];c==null||c.forEach(a=>{const d=a.textContent;d!==null&&r.push(d)}),I(n,r)})}function ne(t){document.querySelectorAll("[cd=drug]").forEach(n=>{const s=document.createElement("option"),l=n.textContent;l!==null&&(s.text=l,s.value=l,s.setAttribute("cd",l),t.add(s))})}function I(t,e){if(e.length>9){t.innerHTML="";const l=document.createElement("option");l.text="Select Medication First",l.value="",t.add(l);return}t.removeAttribute("disabled"),t.classList.remove("disabled"),t.innerHTML="";const n=document.createElement("option");n.text="Select Medication First",n.value="",t.add(n);let s=!0;e.forEach(l=>{if(l==="")return;s=!1;const o=document.createElement("option");o.text=l,o.value=l,t.add(o)}),s&&(t.setAttribute("disabled","true"),t.classList.add("disabled"))}
