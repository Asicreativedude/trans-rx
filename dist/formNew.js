const l={fname:"",lname:"",mname:"",dob:"",ssn:"",address:"",city:"",state:"",zip:"",country:"USA",phone:"",email:"",marital:"",residency:!0,employed:"",sex:"",disabled:!1,numinhouse:"",EmerContactName:"",EmerContactPhone:"",Patwages__c:0,medicationType:""},g={fname:"",mname:"",lname:"",email:"",Phone:"",fax:"",address:"",city:"",state:"",zip:"",Facility_Name__c:"",country:"USA"},y={fname:"",mname:"",lname:"",email:"",Phone:"",fax:"",address:"",city:"",state:"",zip:"",Facility_Name__c:"",country:"USA"},h={Patient__c:"",orderItems:[]},p=Date.now().toString()+Math.random().toString();document.querySelector("#unique-id").value=`${p}`;const $=document.querySelector('[cd="submit-data"]'),N=["Adbry","Admelog","Admelog SoloStar","Aimovig","Anoro Ellipta","Basaglar KwikPen","Basaglar Tempo Pen","Biktarvy","Botox for migraines","Breo Ellipta","Combivent Respimat","Cosentyx","Cosentyx (300 MG Dose)","Cosentyx Sensoready Pen","Creon","Delstrigo","Dupixent","Eliquis","Emgality","Enbrel","Entyvio","Epclusa","Eucrisa","Fasenra","Forteo","HumaLOG","HumaLOG KwikPen","HumaLOG Mix 50/50","HumaLOG Mix 75/25","HumaLOG Mix 75/25 KwikPen","Humira","InFLIXimab","Insulin Degludec","Insulin Degludec FlexTouch","Invokana","Janumet","Janumet XR","Januvia","Jardiance","Kazano","Lantus","Linzess","Lovenox","Lyumjev","Lyumjev KwikPen","Lyumjev Tempo Pen","Motegrity","Multaq","Nesina","NovoLIN 70/30","NovoLIN 70/30 FlexPen","NovoLIN R","NovoLOG","NovoLOG FlexPen","NovoLOG Mix 70/30","NovoLOG Mix 70/30 FlexPen","Nucala","Nurtec","Ocrevus","Olumiant","Ozempic (0.25 or 0.5 MG Dose)","Ozempic (1 MG Dose)","Ozempic (2 MG Dose)","Prezcobix","Qulipta","Remicade","Rexulti","Rinvoq","Rybelsus","Simponi","Simponi Aria","Skyrizi","Skyrizi (150 MG Dose)","Stelara","Stiolto Respimat","Symtuza","Taltz","Toujeo Max SoloStar","Toujeo SoloStar","Trelegy Ellipta","Tremfya","Tresiba","Tresiba FlexTouch","Trintellix","Ubrelvy","Viberzi","Xarelto","Xeljanz","Xeljanz XR","Zenpep","Zepatier","Zubsolv"];let z=0;$.addEventListener("click",()=>{M()});async function M(){patientAddress&&patientAddress.forEach(t=>{switch(t.types[0]){case"street_number":{l.address=`${t.long_name} `;break}case"route":{l.address+=t.short_name;break}case"locality":l.city=t.long_name;break;case"administrative_area_level_1":{l.state=t.short_name;break}}}),doctorAddress&&doctorAddress.forEach(t=>{switch(t.types[0]){case"street_number":{g.address=`${t.long_name} `;break}case"route":{g.address+=t.short_name;break}case"locality":g.city=t.long_name;break;case"administrative_area_level_1":{g.state=t.short_name;break}}}),doctor2Address&&doctor2Address.forEach(t=>{switch(t.types[0]){case"street_number":{y.address=`${t.long_name} `;break}case"route":{y.address+=t.short_name;break}case"locality":y.city=t.long_name;break;case"administrative_area_level_1":{y.state=t.short_name;break}}});const e=[];document.querySelectorAll(".input-field").forEach(t=>{let n=t.id,o=t.value;(n.includes("phone")||n.includes("fax"))&&(o=o.replace(/\D/g,"")),e.push({field:n,value:o})}),document.querySelectorAll("input[type=radio]:checked").forEach(t=>{let n=t.name,o=t.id;t.name==="residency"?e.push({field:n,value:"US Citizen/Resident"}):e.push({field:n,value:o})}),e.forEach(t=>{t.field.includes("choose")&&t.value!==""&&h.orderItems.push({Doctor__c:t.value,Medication_Name__c:"",Frequency__c:"",Strength__c:"",timeStamp:""})}),e.forEach(t=>{if(t.field.includes("doc-")){let n=t.field.split("-")[1];if(g[n]=t.value,n==="office"){g.Facility_Name__c=t.value;return}if(n==="officephone"){g.Phone=t.value;return}return}if(t.field.includes("doc2-")){let n=t.field.split("-")[1];if(y[n]=t.value,n==="office"){y.Facility_Name__c=t.value;return}if(n==="officephone"){y.Phone=t.value;return}return}if(t.field==="month"){const n=t.value.length===1?`0${t.value}`:t.value;l.dob=`${n}`;return}if(t.field==="marital"){l.marital=t.value;return}if(t.field==="employed"){l.employed=t.value;return}if(t.field==="patwages"){l.Patwages__c=parseFloat(t.value.split("$")[1].replace(/,/g,""));return}if(t.field==="day"||t.field==="year"){l.dob=`${l.dob}-${t.value}`;return}if(t.field==="disabled"){l[t.field]=t.value==="Yes";return}if(t.field==="ssn"){l[t.field]=t.value.replace(/-/g,"");return}if(t.field==="dayphone"){l.phone=t.value.replace(/-/g,"");return}if(!(t.field.includes("choose")||t.field.includes("residency"))){if(t.field.includes("med-name-")&&t.value!==""){let n=t.field.split("-")[2];h.orderItems[n-1].Medication_Name__c=t.value;return}if(t.field.includes("med-strength-")&&t.value!==""){let n=t.field.split("-")[2];h.orderItems[n-1].Strength__c=t.value;return}if(t.field.includes("Frequency")&&t.value!==""){let n=t.field.split("-")[1];h.orderItems[n-1].Frequency__c=t.value;return}t.field.includes("segment-field")&&(l.medicationType=t.value),l[t.field]=t.value}});const i=l.dob.split("-");l.dob=`${i[2]}-${i[1]}-${i[0]}`,h.orderItems.forEach(t=>{t.timeStamp=new Date().toISOString()});const s={patient:l,doctor:g,doctor2:y,orders:h,uniqueId:p};sessionStorage.setItem("formData",JSON.stringify(s)),sessionStorage.setItem(p,JSON.stringify(s)),T(p)}const T=async e=>{const s=await(await fetch("https://voluble-axolotl-2e6e1c.netlify.app/.netlify/functions/create-stripe-session",{method:"POST",body:JSON.stringify({uniqueId:e}),headers:{"Content-Type":"application/json"}})).json();window.location.href=s.checkoutURL};function O(){const e=document.getElementById("segment-field");for(let i=1;i<5;i++){const t=document.getElementById(`med-name-${i}`).value;if(t==="")return;if(t!==N.find(n=>n===t)){if(e.value==="Brand"){e.value="Both";return}e.value="Generic";return}else{if(e.value==="Generic"){e.value="Both";return}e.value="Brand"}}}const w=document.getElementById("year"),P=105;for(let e=P;e>0;e--){const i=document.createElement("option");i.text=`${e+1900}`,i.value=`${e+1900}`,w.add(i)}function D(e,i,s,t){let n=0;i.style.display="none";const o=e.length;e.forEach((r,d)=>{d!==n&&(r.style.display="none")}),i.addEventListener("click",()=>{n===3&&(s.innerHTML="Continue"),n>0&&(e[n].style.display="none",n--,e[n].style.display="block"),t.forEach((r,d)=>{d!==n?r.classList.remove("current"):r.classList.add("current")}),n===0?i.style.display="none":i.style.display="block"}),s.addEventListener("click",()=>{const r=e[n].querySelectorAll("input"),d=e[n].querySelectorAll("select");if(R(r,d,n)){if(n===3){O(),document.querySelector(".submit-btn").click();return}else n<o-1&&(e[n].style.display="none",n++,e[n].style.display="block"),t.forEach((a,u)=>{u!==n?a.classList.remove("current"):a.classList.add("current")}),n===0?i.style.display="none":i.style.display="block",n===3&&(s.innerHTML="Continue To Payment");n===2&&(z=ie(parseFloat(document.getElementById("numinhouse").value),parseFloat(document.getElementById("patwages").value.split("$")[1].replace(/,/g,""))))}})}const F=document.querySelectorAll("[cd-form = step]"),C=document.querySelector("[cd-form = button-back]"),G=document.querySelector("[cd-form = button-next]"),L=document.querySelectorAll("[cd-form=progress-indicator]");D(F,C,G,L);function R(e,i,s){let t=!0;e.forEach(a=>{if(a.required)if(a.value===""){if(a.id==="doc2-mname")return;t=!1,a.nextElementSibling.classList.add("active")}else{if(a.id==="doc2-mname")return;a.nextElementSibling.classList.remove("active")}}),i.forEach(a=>{a.required&&(a.value===""?(t=!1,a.nextElementSibling.classList.add("active")):a.nextElementSibling.classList.remove("active"))});const n=document.querySelectorAll("input[name=sex]:checked"),o=document.querySelectorAll("input[name=residency]:checked"),r=document.querySelectorAll("input[name=disabled]:checked");if(n.length===0?(document.getElementById("sex-radio-error").classList.add("active"),t=!1):document.getElementById("sex-radio-error").classList.remove("active"),o.length===0?(document.getElementById("citizen-radio-error").classList.add("active"),t=!1):o[0].id==="No"?(document.querySelector(".error-announcement-c").classList.add("active"),t=!1):(document.querySelector(".error-announcement-c").classList.remove("active"),document.getElementById("citizen-radio-error").classList.remove("active")),r.length===0?(document.getElementById("disabled-radio-error").classList.add("active"),t=!1):document.getElementById("disabled-radio-error").classList.remove("active"),document.getElementById("ssn").value.length!==11?(t=!1,document.getElementById("ssn-error").classList.add("active")):document.getElementById("ssn-error").classList.remove("active"),s===1){const a=document.getElementById("email");if(!a.required)return;/\S+@\S+\.\S+/.test(a.value)?a.nextElementSibling.classList.remove("active"):(t=!1,a.nextElementSibling.classList.add("active"));const c=document.getElementById("dayphone"),m=document.getElementById("EmerContactPhone");c.value.length!==16?(t=!1,c.nextElementSibling.classList.add("active")):c.nextElementSibling.classList.remove("active"),m.value.length!==16?(t=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active");const f=document.getElementById("zip");f.value.length!==5?(t=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active");const v=document.getElementById("patientAddress");_(v.value)===!1?(t=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active")}if(s===2){const a=document.getElementById("doc-email"),u=document.getElementById("doc2-email-2");for(let A=1;A<5;A++)te(document.getElementById(`med-name-${A}`));const c=/\S+@\S+\.\S+/;!c.test(a.value)&&a.value!==""?(t=!1,a.nextElementSibling.classList.add("active")):a.nextElementSibling.classList.remove("active"),u.value!==""&&(c.test(u.value)?u.nextElementSibling.classList.remove("active"):(t=!1,u.nextElementSibling.classList.add("active")));const m=document.getElementById("doc-officephone-2"),f=document.getElementById("doc-fax"),v=document.getElementById("doc2-officephone-2"),E=document.getElementById("doc2-fax-2");m.value.length!==16?(t=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active"),f.value.length!==16?(t=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active"),v.value!==""&&(v.value.length!==16?(t=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active")),E.value!==""&&(E.value.length!==16?(t=!1,E.nextElementSibling.classList.add("active")):E.nextElementSibling.classList.remove("active"));const I=document.getElementById("doctorAddress");_(I.value)===!1?(t=!1,I.nextElementSibling.classList.add("active")):I.nextElementSibling.classList.remove("active");const S=document.getElementById("doctor2Address");S.value!==""&&(_(S.value)===!1?(t=!1,S.nextElementSibling.classList.add("active")):S.nextElementSibling.classList.remove("active"));const q=document.getElementById("doc-zip-2"),b=document.getElementById("doc2-zip-2");q.value.length!==5?(t=!1,q.nextElementSibling.classList.add("active")):q.nextElementSibling.classList.remove("active"),b.value!==""&&(b.value.length!==5?(t=!1,b.nextElementSibling.classList.add("active")):b.nextElementSibling.classList.remove("active"))}if(s===3)for(let a=1;a<5;a++){const u=document.getElementById(`coverage-${a}`),c=document.getElementById(`coverage-checkbox-${a}`);!u.classList.contains("hidden")&&!c.checked?(t=!1,u.querySelector(".error-message").classList.add("active")):u.querySelector(".error-message").classList.remove("active")}return t}const x=document.querySelector(".second-doc");x.querySelectorAll(".input-field").forEach(e=>{e.addEventListener("change",()=>{e.value!==""?x.querySelectorAll(".input-field").forEach(i=>{i.name==="doc2-email"||i.name==="doc2-mname"||(i.required=!0)}):Array.from(x.querySelectorAll(".input-field")).every(s=>s.value==="")&&x.querySelectorAll(".input-field").forEach(s=>{s.required=!1,s.nextElementSibling.classList.remove("active")})})});const j=document.querySelectorAll(".phone-field");function H(e){e.addEventListener("input",function(){this.value=this.value.replace(/\D/g,"");const i=this.value.replace(/\D/g,"").substring(0,10),s=i.substring(0,3),t=i.substring(3,6),n=i.substring(6,10);i.length>6?this.value=`(${s}) ${t} - ${n}`:i.length>3?this.value=`(${s}) ${t}`:i.length>0&&(this.value=`(${s}`)})}j.forEach(e=>{H(e)});const X=document.querySelectorAll('input[placeholder="Zip code"]');X.forEach(e=>{e.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>5&&(this.value=this.value.slice(0,5))})});function J(e){return e.replace(/\D/g,"").replace(/^(\d{3})(\d{2})(\d{0,4})$/,(t,n,o,r)=>r?`${n}-${o}-${r}`:o?`${n}-${o}`:n)}function K(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}document.querySelectorAll('[cd="capitelize"]').forEach(e=>{e.addEventListener("change",function(){this.value=K(this.value)})});const U=document.getElementById("ssn");U.addEventListener("input",function(){this.value=J(this.value)});function _(e){return/^[^,]+,\s*[^,]+,\s*[A-Z]{2},\s*USA$/.test(e)}const B=document.querySelector(".money-field"),Z=document.getElementById("employed");Z.addEventListener("change",function(){if(this.value==="Unemployed"){B.value="$25,000";return}B.value=""});B.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value!==""&&(this.value="$"+parseInt(this.value).toLocaleString())});const k=document.querySelector(".progress-bar-c"),V=document.querySelector(".progress-bar"),Q={attributes:!0};function W(e){e.forEach(function(i){if(i.type==="attributes"&&i.attributeName==="class"){let s=Array.from(L).findIndex(t=>t.classList.contains("current"));V.style.width=`${(s+1)/L.length*100}%`,window.innerWidth<768&&(s===2?k.style.transform=`translateX(-${516-window.innerWidth}px)`:s<2&&(k.style.transform="translateX(0px)"))}})}let Y=new MutationObserver(W);L.forEach(e=>{Y.observe(e,Q)});function ee(){let e=!0;for(let i=1;i<5;i++){const t=document.getElementById(`med-name-${i}`).value;re(z,t)||(e=!1,document.querySelector(".eligibility-announcement-c").classList.remove("hidden"),document.querySelector(".eligability-med-name").textContent=t)}e&&document.querySelector(".eligibility-announcement-c").classList.add("hidden")}for(let e=1;e<5;e++){const i=document.getElementById(`med-name-${e}`),s=document.getElementById(`med-strength-${e}`);if(i.addEventListener("change",t=>{ee();const n=document.getElementById(`coverage-${e}`),o=document.getElementById(`coverage-checkbox-${e}`);console.log(i.value),N.find(c=>c===i.value)?(n.classList.remove("hidden"),o.required=!0):(n.classList.add("hidden"),o.required=!1),e!==1&&(i.value!==""?(document.getElementById(`med-strength-${e}`).required=!0,document.getElementById(`choose-doctor-${e}`).required=!0):(document.getElementById(`med-strength-${e}`).required=!1,document.getElementById(`choose-doctor-${e}`).required=!1)),s.innerHTML="";let r=t.target.value.toLocaleLowerCase().replace(/[\(\)\/.]/g,"").split(" ").join("-");if(r===""){const c=document.createElement("option");c.text="Select Medication First",c.value="",s.add(c);return}r==="ozempic-025-or-05-mg-dose"?r="ozempic-0-25-or-0-5-mg-dose":r==="novolog-mix-7030"?r="novolog-mix-70-30":r==="novolin-7030"?r="novolin-70-30":r==="novolin-7030-flexpen"?r="novolin-70-30-flexpen":r==="novolog-mix-7030-flexpen"?r="novolog-mix-70-30-flexpen":r==="humalog-mix-5050"?r="humalog-mix-50-50":r==="humalog-mix-7525"?r="humalog-mix-75-25":r==="humalog-mix-7525-kwikpen"?r="humalog-mix-75-25-kwikpen":r==="prodigy-insulin-syringe-31g-8mm-13cc"?r="prodigy-insulin-syringe-31g-8mm-1-3cc":r==="prodigy-insulin-syringe-31g-8mm-12cc"?r="prodigy-insulin-syringe-31g-8mm-1-2cc":r==="prodigy-insulin-syringe-28g-127mm-1cc"?r="prodigy-insulin-syringe-28g-12-7mm-1cc":r==="entocort-ecr"&&(r="entocort-ec-r");const d=document.querySelector(`[cd-name=${r}]`).parentElement,a=d==null?void 0:d.querySelectorAll("[cd=strength]"),u=[];a==null||a.forEach(c=>{const m={strength:c.textContent};m.strength!==null&&u.push(m)}),ne(s,u)}),e!==1){const t=document.getElementById(`med-row-${e}`);t.querySelectorAll(".input-field").forEach(n=>{n.addEventListener("change",()=>{n.value!==""?t.querySelectorAll(".input-field").forEach(o=>{o.required=!0}):Array.from(t.querySelectorAll(".input-field")).every(r=>r.value==="")&&t.querySelectorAll(".input-field").forEach(r=>{r.required=!1,r.nextElementSibling.classList.remove("active")})})})}}function te(e){document.querySelectorAll("[cd=drug]").forEach(s=>{const t=document.createElement("option"),n=s.textContent,o=s.getAttribute("cd-generic"),r=s.getAttribute("cd-program"),d=s.getAttribute("cd-diagnosis");n!==null&&(t.text=`${n} (${o})`,t.value=n,t.setAttribute("cd-program",r),t.setAttribute("cd-diagnosis",d),e.add(t))})}function ne(e,i){if(i.length>9){e.innerHTML="";const n=document.createElement("option");n.text="Select Medication First",n.value="",e.add(n);return}e.removeAttribute("disabled"),e.classList.remove("disabled"),e.innerHTML="";const s=document.createElement("option");s.text="Select Medication First",s.value="",e.add(s);let t=!0;i.forEach(n=>{if(n.strength==="")return;t=!1;const o=document.createElement("option");o.text=n.strength,o.value=n.strength,e.add(o)}),t&&(e.setAttribute("disabled","true"),e.classList.add("disabled"),e.removeAttribute("required"))}document.getElementById("wf-form-application-form").addEventListener("submit",()=>{$.click()});function ie(e,i){return Math.round(i/(15060+(e-1)*5380)*100)}function re(e,i){switch(i){case"Adbry":return e<=600;case"Admelog":return e<=500;case"Admelog SoloStar":return e<=500;case"Aimovig":return e<=290;case"Anoro Ellipta":return e<=300;case"Basaglar KwikPen":return e<=500;case"Basaglar Tempo Pen":return e<=500;case"Biktarvy":return e<=500;case"Botox for migraines":return e<=600;case"Breo Ellipta":return e<=300;case"Cimzia":return e<=500;case"Combivent Respimat":return e<=200;case"Cosentyx":return e<=550;case"Cosentyx (300 MG Dose)":return e<=550;case"Cosentyx Sensoready Pen":return e<=550;case"Creon":return e<=600;case"Delstrigo":return e<=400;case"Dupixent For Asthma":return e<=400;case"Dupixent for Prurigo Nodularis":return e<=400;case"Dupixent for Rhinosinusitis with Nasal Polyposis":return e<=400;case"Dupixent for Eosinophilic Esophagitis":return e<=400;case"Dupixent for Atopic Dermatitis":return e<=400;case"Eliquis":return e<=250;case"Emgality":return e<=400;case"Enbrel":return e<=290;case"Entyvio":return e<=500;case"Epclusa":return e<=500;case"Eucrisa":return e<=300;case"Fasenra":return e<=300;case"Forteo":return e<=300;case"HumaLOG":return e<=500;case"HumaLOG KwikPen":return e<=500;case"HumaLOG Mix 50/50":return e<=400;case"HumaLOG Mix 75/25":return e<=400;case"HumaLOG Mix 75/25 KwikPen":return e<=400;case"Humira":return e<=600;case"inFLIXimab":return e<=600;case"Invokana":return e<=305;case"Janumet":return e<=400;case"Janumet XR":return e<=400;case"Januvia":return e<=400;case"Jardiance":return e<=250;case"Kazano":return e<=500;case"Lantus":return e<=400;case"Linzess":return e<=600;case"Lovenox":return e<=400;case"Lyumjev":return e<=400;case"Lyumjev KwikPen":return e<=500;case"Lyumjev Tempo Pen":return e<=500;case"Motegrity":return e<=500;case"Multaq":return e<=400;case"Nesina":return e<=500;case"NovoLIN 70/30":return e<=400;case"NovoLIN 70/30 FlexPen":return e<=400;case"NovoLIN R":return e<=500;case"NovoLOG":return e<=400;case"NovoLOG FlexPen":return e<=400;case"NovoLOG Mix 70/30":return e<=400;case"NovoLOG Mix 70/30 FlexPen":return e<=400;case"Nucala":return e<=600;case"Nurtec":return e<=300;case"Ocrevus":return e<=1e3;case"Olumiant":return e<=500;case"Ozempic (0.25 or 0.5 MG Dose)":return e<=400;case"Ozempic (1 MG Dose)":return e<=400;case"Ozempic (2 MG Dose)":return e<=400;case"Qulipta":return e<=600;case"Remicade":return e<=600;case"Rexulti":return e<=400;case"Rinvoq":return e<=600;case"Rybelsus":return e<=400;case"Simponi":return e<=600;case"Simponi Aria":return e<=600;case"Skyrizi":return e<=600;case"Skyrizi (150 MG Dose)":return e<=600;case"Stelara":return e<=600;case"Stiolto Respimat":return e<=200;case"Symtuza":return e<=300;case"Taltz":return e<=500;case"Toujeo Max SoloStar":return e<=400;case"Toujeo SoloStar":return e<=400;case"Trelegy Ellipta":return e<=600;case"Tremfya":return e<=600;case"Tresiba":return e<=500;case"Tresiba FlexTouch":return e<=400;case"Trintellix":return e<=500;case"Ubrelvy":return e<=600;case"Viberzi":return e<=600;case"Xarelto":return e<=300;case"Xeljanz":return e<=500;case"Xeljanz XR":return e<=500;case"Zenpep":return e<=400;case"Zepatier":return e<=400;case"Zubsolv":return e<=300;default:return!0}}
