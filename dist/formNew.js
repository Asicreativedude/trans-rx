const o={fname:"",lname:"",mname:"",dob:"",ssn:"",address:"",city:"",state:"",zip:"",country:"USA",phone:"",email:"",marital:"",residency:!0,employed:"",sex:"",disabled:!1,numinhouse:"",EmerContactName:"",EmerContactPhone:"",Patwages__c:0,insurance:"",medicationType:""},m={fname:"",mname:"",lname:"",email:"",Phone:"",fax:"",address:"",city:"",state:"",zip:"",Facility_Name__c:"",country:"USA"},f={fname:"",mname:"",lname:"",email:"",Phone:"",fax:"",address:"",city:"",state:"",zip:"",Facility_Name__c:"",country:"USA"},p={Patient__c:"",orderItems:[]},L=Date.now().toString()+Math.random().toString();document.querySelector("#unique-id").value=`${L}`;const $=document.querySelector('[cd="submit-data"]'),w=["Adbry","Admelog","Admelog SoloStar","Aimovig","Anoro Ellipta","Avsola","Basaglar KwikPen","Basaglar Tempo Pen","Biktarvy","Botox Cosmetic","Botox for migraines","Breo Ellipta","Cimzia","Combivent Respimat","Cosentyx","Cosentyx (300 MG Dose)","Cosentyx Sensoready Pen","Creon","Delstrigo","Dupixent","Eliquis","Emgality","Enbrel","Entyvio","Epclusa","Eucrisa","Evotaz","Fasenra","Forteo","HumaLOG","HumaLOG KwikPen","HumaLOG Mix 50/50","HumaLOG Mix 75/25","HumaLOG Mix 75/25 KwikPen","Humira","inFLIXimab","Insulin Degludec","Insulin Degludec FlexTouch","Invokana","Janumet","Janumet XR","Januvia","Jardiance","Kazano","Lantus","Linzess","Lovenox","Lyumjev","Lyumjev KwikPen","Lyumjev Tempo Pen","Motegrity","Multaq","Nesina","NovoLIN 70/30","NovoLIN 70/30 FlexPen","NovoLIN R","NovoLOG","NovoLOG FlexPen","NovoLOG Mix 70/30","NovoLOG Mix 70/30 FlexPen","Nucala","Nurtec","Ocrevus","Olumiant","Ozempic (0.25 or 0.5 MG Dose)","Ozempic (1 MG Dose)","Ozempic (2 MG Dose)","Prezcobix","Prolia","Qulipta","Remicade","Rexulti","Rinvoq","Rybelsus","Simponi","Simponi Aria","Skyrizi","Skyrizi (150 MG Dose)","Steglatro","Stelara","Stiolto Respimat","Symtuza","Taltz","Tobi Podhaler","Toujeo Max SoloStar","Toujeo SoloStar","Trelegy Ellipta","Tremfya","Tresiba","Tresiba FlexTouch","Trintellix","Ubrelvy","Viberzi","Xarelto","Xeljanz","Xeljanz XR","Zenpep","Zepatier","Zubsolv"];$.addEventListener("click",()=>{k()});async function k(){patientAddress&&patientAddress.forEach(e=>{switch(e.types[0]){case"street_number":{o.address=`${e.long_name} `;break}case"route":{o.address+=e.short_name;break}case"locality":o.city=e.long_name;break;case"administrative_area_level_1":{o.state=e.short_name;break}}}),doctorAddress&&doctorAddress.forEach(e=>{switch(e.types[0]){case"street_number":{m.address=`${e.long_name} `;break}case"route":{m.address+=e.short_name;break}case"locality":m.city=e.long_name;break;case"administrative_area_level_1":{m.state=e.short_name;break}}}),doctor2Address&&doctor2Address.forEach(e=>{switch(e.types[0]){case"street_number":{f.address=`${e.long_name} `;break}case"route":{f.address+=e.short_name;break}case"locality":f.city=e.long_name;break;case"administrative_area_level_1":{f.state=e.short_name;break}}});const n=[];document.querySelectorAll(".input-field").forEach(e=>{let t=e.id,r=e.value;(t.includes("phone")||t.includes("fax"))&&(r=r.replace(/\D/g,"")),n.push({field:t,value:r})}),document.querySelectorAll("input[type=radio]:checked").forEach(e=>{let t=e.name,r=e.id;e.name==="residency"?n.push({field:t,value:"US Citizen/Resident"}):n.push({field:t,value:r})}),n.forEach(e=>{e.field.includes("choose")&&e.value!==""&&p.orderItems.push({Doctor__c:e.value,Medication_Name__c:"",Frequency__c:"",Strength__c:""})}),n.forEach(e=>{if(e.field.includes("doc-")){let t=e.field.split("-")[1];if(m[t]=e.value,t==="office"){m.Facility_Name__c=e.value;return}if(t==="officephone"){m.Phone=e.value;return}return}if(e.field.includes("doc2-")){let t=e.field.split("-")[1];if(f[t]=e.value,t==="office"){f.Facility_Name__c=e.value;return}if(t==="officephone"){f.Phone=e.value;return}return}if(e.field==="month"){const t=e.value.length===1?`0${e.value}`:e.value;o.dob=`${t}`;return}if(e.field==="marital"){o.marital=e.value;return}if(e.field==="employed"){o.employed=e.value;return}if(e.field==="patwages"){o.Patwages__c=parseFloat(e.value.split("$")[1]);return}if(e.field==="day"||e.field==="year"){o.dob=`${o.dob}-${e.value}`;return}if(e.field==="disabled"){o[e.field]=e.value==="Yes";return}if(e.field==="ssn"){o[e.field]=e.value.replace(/-/g,"");return}if(e.field==="dayphone"){o.phone=e.value.replace(/-/g,"");return}if(!(e.field.includes("choose")||e.field.includes("residency"))){if(e.field.includes("med-name-")&&e.value!==""){let t=e.field.split("-")[2];p.orderItems[t-1].Medication_Name__c=e.value;return}if(e.field.includes("med-strength-")&&e.value!==""){let t=e.field.split("-")[2];p.orderItems[t-1].Strength__c=e.value;return}if(e.field.includes("Frequency")&&e.value!==""){let t=e.field.split("-")[1];p.orderItems[t-1].Frequency__c=e.value;return}if(e.field.includes("insurance")){o.insurance=e.value;return}e.field.includes("segment-field")&&(o.medicationType=e.value),o[e.field]=e.value}});const i=o.dob.split("-");o.dob=`${i[2]}-${i[1]}-${i[0]}`;const l={patient:o,doctor:m,doctor2:f,orders:p,uniqueId:L};sessionStorage.setItem("formData",JSON.stringify(l)),sessionStorage.setItem(L,JSON.stringify(l)),z(L)}const z=async n=>{console.log("redirecting to stripe",n)};function T(){const n=document.getElementById("segment-field");for(let i=1;i<5;i++){const e=document.getElementById(`med-name-${i}`).value;if(e==="")return;if(e!==w.find(t=>t===e)){if(n.value==="Brand"){n.value="Both";return}n.value="Generic";return}else{if(n.value==="Generic"){n.value="Both";return}n.value="Brand"}}}const M=document.getElementById("year"),N=105;for(let n=N;n>0;n--){const i=document.createElement("option");i.text=`${n+1900}`,i.value=`${n+1900}`,M.add(i)}function P(n,i,l,e){let t=0;i.style.display="none";const r=n.length;n.forEach((a,c)=>{c!==t&&(a.style.display="none")}),i.addEventListener("click",()=>{t===3&&(l.innerHTML="Continue"),t>0&&(n[t].style.display="none",t--,n[t].style.display="block"),e.forEach((a,c)=>{c!==t?a.classList.remove("current"):a.classList.add("current")}),t===0?i.style.display="none":i.style.display="block"}),l.addEventListener("click",()=>{const a=n[t].querySelectorAll("input"),c=n[t].querySelectorAll("select");if(C(a,c,t))if(t===3){T(),$.click();return}else t<r-1&&(n[t].style.display="none",t++,n[t].style.display="block"),e.forEach((s,d)=>{d!==t?s.classList.remove("current"):s.classList.add("current")}),t===0?i.style.display="none":i.style.display="block",t===3&&(l.innerHTML="Continue To Payment")})}const F=document.querySelectorAll("[cd-form = step]"),O=document.querySelector("[cd-form = button-back]"),D=document.querySelector("[cd-form = button-next]"),x=document.querySelectorAll("[cd-form=progress-indicator]");P(F,O,D,x);function C(n,i,l){let e=!0;n.forEach(s=>{if(s.required)if(s.value===""){if(s.id==="doc2-mname")return;e=!1,s.nextElementSibling.classList.add("active")}else{if(s.id==="doc2-mname")return;s.nextElementSibling.classList.remove("active")}}),i.forEach(s=>{s.required&&(s.value===""?(e=!1,s.nextElementSibling.classList.add("active")):s.nextElementSibling.classList.remove("active"))});const t=document.querySelectorAll("input[name=sex]:checked"),r=document.querySelectorAll("input[name=residency]:checked"),a=document.querySelectorAll("input[name=disabled]:checked");if(t.length===0?(document.getElementById("sex-radio-error").classList.add("active"),e=!1):document.getElementById("sex-radio-error").classList.remove("active"),r.length===0?(document.getElementById("citizen-radio-error").classList.add("active"),e=!1):r[0].id==="No"?(document.querySelector(".error-announcement-c").classList.add("active"),e=!1):(document.querySelector(".error-announcement-c").classList.remove("active"),document.getElementById("citizen-radio-error").classList.remove("active")),a.length===0?(document.getElementById("disabled-radio-error").classList.add("active"),e=!1):document.getElementById("disabled-radio-error").classList.remove("active"),document.getElementById("ssn").value.length!==11?(e=!1,document.getElementById("ssn-error").classList.add("active")):document.getElementById("ssn-error").classList.remove("active"),l===1){const s=document.getElementById("email");if(!s.required)return;/\S+@\S+\.\S+/.test(s.value)?s.nextElementSibling.classList.remove("active"):(e=!1,s.nextElementSibling.classList.add("active"));const y=document.getElementById("dayphone"),v=document.getElementById("EmerContactPhone");y.value.length!==16?(e=!1,y.nextElementSibling.classList.add("active")):y.nextElementSibling.classList.remove("active"),v.value.length!==16?(e=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active");const g=document.getElementById("zip");g.value.length!==5?(e=!1,g.nextElementSibling.classList.add("active")):g.nextElementSibling.classList.remove("active");const u=document.getElementById("patientAddress");q(u.value)===!1?(e=!1,u.nextElementSibling.classList.add("active")):u.nextElementSibling.classList.remove("active")}if(l===2){const s=document.getElementById("doc-email"),d=document.getElementById("doc2-email-2");for(let _=1;_<5;_++)V(document.getElementById(`med-name-${_}`));const y=/\S+@\S+\.\S+/;!y.test(s.value)&&s.value!==""?(e=!1,s.nextElementSibling.classList.add("active")):s.nextElementSibling.classList.remove("active"),d.value!==""&&(y.test(d.value)?d.nextElementSibling.classList.remove("active"):(e=!1,d.nextElementSibling.classList.add("active")));const v=document.getElementById("doc-officephone-2"),g=document.getElementById("doc-fax"),u=document.getElementById("doc2-officephone-2"),h=document.getElementById("doc2-fax-2");v.value.length!==16?(e=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active"),g.value.length!==16?(e=!1,g.nextElementSibling.classList.add("active")):g.nextElementSibling.classList.remove("active"),u.value!==""&&(u.value.length!==16?(e=!1,u.nextElementSibling.classList.add("active")):u.nextElementSibling.classList.remove("active")),h.value!==""&&(h.value.length!==16?(e=!1,h.nextElementSibling.classList.add("active")):h.nextElementSibling.classList.remove("active"));const I=document.getElementById("doctorAddress");q(I.value)===!1?(e=!1,I.nextElementSibling.classList.add("active")):I.nextElementSibling.classList.remove("active");const E=document.getElementById("doctor2Address");E.value!==""&&(q(E.value)===!1?(e=!1,E.nextElementSibling.classList.add("active")):E.nextElementSibling.classList.remove("active"));const A=document.getElementById("doc-zip-2"),b=document.getElementById("doc2-zip-2");A.value.length!==5?(e=!1,A.nextElementSibling.classList.add("active")):A.nextElementSibling.classList.remove("active"),b.value!==""&&(b.value.length!==5?(e=!1,b.nextElementSibling.classList.add("active")):b.nextElementSibling.classList.remove("active"))}return e}const S=document.querySelector(".second-doc");S.querySelectorAll(".input-field").forEach(n=>{n.addEventListener("change",()=>{n.value!==""?S.querySelectorAll(".input-field").forEach(i=>{i.name!=="doc2-email"&&(i.required=!0)}):Array.from(S.querySelectorAll(".input-field")).every(l=>l.value==="")&&S.querySelectorAll(".input-field").forEach(l=>{l.getAttribute("id")!=="doc2-mname"&&(l.required=!1,l.nextElementSibling.classList.remove("active"))})})});const G=document.querySelectorAll(".phone-field");function R(n){n.addEventListener("input",function(){this.value=this.value.replace(/\D/g,"");const i=this.value.replace(/\D/g,"").substring(0,10),l=i.substring(0,3),e=i.substring(3,6),t=i.substring(6,10);i.length>6?this.value=`(${l}) ${e} - ${t}`:i.length>3?this.value=`(${l}) ${e}`:i.length>0&&(this.value=`(${l}`)})}G.forEach(n=>{R(n)});const H=document.querySelectorAll('input[placeholder="Zip code"]');H.forEach(n=>{n.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>5&&(this.value=this.value.slice(0,5))})});function j(n){return n.replace(/\D/g,"").replace(/^(\d{3})(\d{2})(\d{0,4})$/,(e,t,r,a)=>a?`${t}-${r}-${a}`:r?`${t}-${r}`:t)}const X=document.getElementById("ssn");X.addEventListener("input",function(){this.value=j(this.value)});function q(n){return/^[^,]+,\s*[^,]+,\s*[A-Z]{2},\s*USA$/.test(n)}const J=document.querySelector(".money-field");J.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value!==""&&(this.value="$"+parseInt(this.value).toLocaleString())});const B=document.querySelector(".progress-bar-c"),U=document.querySelector(".progress-bar"),K={attributes:!0};function Z(n){n.forEach(function(i){if(i.type==="attributes"&&i.attributeName==="class"){let l=Array.from(x).findIndex(e=>e.classList.contains("current"));U.style.width=`${(l+1)/x.length*100}%`,window.innerWidth<768&&(l===2?B.style.transform=`translateX(-${516-window.innerWidth}px)`:l<2&&(B.style.transform="translateX(0px)"))}})}let W=new MutationObserver(Z);x.forEach(n=>{W.observe(n,K)});function Q(){let n=!1;for(let i=1;i<5;i++){const e=document.getElementById(`med-name-${i}`).value;e===w.find(t=>t===e)&&(n=!0)}n?(document.getElementById("insurance-row").classList.remove("hidden"),document.getElementById("insurance-field").required=!0,document.getElementById("brand-note").classList.remove("hidden")):(document.getElementById("insurance-row").classList.add("hidden"),document.getElementById("insurance-field").required=!1,document.getElementById("brand-note").classList.add("hidden"))}for(let n=1;n<5;n++){const i=document.getElementById(`med-name-${n}`),l=document.getElementById(`med-strength-${n}`);if(i.addEventListener("change",e=>{Q(),n!==1&&(i.value!==""?(document.getElementById(`med-strength-${n}`).required=!0,document.getElementById(`choose-doctor-${n}`).required=!0):(document.getElementById(`med-strength-${n}`).required=!1,document.getElementById(`choose-doctor-${n}`).required=!1)),l.innerHTML="";let t=e.target.value.toLocaleLowerCase().replace(/[\(\)\/.]/g,"").split(" ").join("-");if(t===""){const s=document.createElement("option");s.text="Select Medication First",s.value="",l.add(s);return}t==="ozempic-025-or-05-mg-dose"&&(t="ozempic-0-25-or-0-5-mg-dose");const r=document.querySelector(`[cd-name=${t}]`).parentElement,a=r==null?void 0:r.querySelectorAll("[cd=strength]"),c=[];a==null||a.forEach(s=>{const d={strength:s.textContent,webpapId:s.getAttribute("cd-webpap-id")};d.strength!==null&&c.push(d)}),Y(l,c)}),n!==1){const e=document.getElementById(`med-row-${n}`);e.querySelectorAll(".input-field").forEach(t=>{t.addEventListener("change",()=>{t.value!==""?e.querySelectorAll(".input-field").forEach(r=>{r.required=!0}):Array.from(e.querySelectorAll(".input-field")).every(a=>a.value==="")&&e.querySelectorAll(".input-field").forEach(a=>{a.required=!1,a.nextElementSibling.classList.remove("active")})})})}}function V(n){document.querySelectorAll("[cd=drug]").forEach(l=>{const e=document.createElement("option"),t=l.textContent,r=l.getAttribute("cd-webpap-name"),a=l.getAttribute("cd-program"),c=l.getAttribute("cd-diagnosis"),s=l.getAttribute("cd-webpap-id");t!==null&&(e.text=t,e.value=t,e.setAttribute("cd-webpap-name",r),e.setAttribute("cd-program",a),e.setAttribute("cd-diagnosis",c),e.setAttribute("cd-webpap-id",s),n.add(e))})}function Y(n,i){if(i.length>9){n.innerHTML="";const t=document.createElement("option");t.text="Select Medication First",t.value="",n.add(t);return}n.removeAttribute("disabled"),n.classList.remove("disabled"),n.innerHTML="";const l=document.createElement("option");l.text="Select Medication First",l.value="",n.add(l);let e=!0;i.forEach(t=>{if(t.strength==="")return;e=!1;const r=document.createElement("option");r.text=t.strength,r.value=t.strength,r.setAttribute("cd-webpap-id",t.webpapId),n.add(r)}),e&&(n.setAttribute("disabled","true"),n.classList.add("disabled"),n.removeAttribute("required"))}
