const c={fname:"",lname:"",mname:"",dob:"",ssn:"",address:"",city:"",state:"",zip:"",country:"USA",phone:"",email:"",marital:"",residency:!0,employed:"",sex:"",disabled:!1,numinhouse:"",EmerContactName:"",EmerContactPhone1:"",patwages:"",insurance:""},g={fname:"",mname:"",lname:"",email:"",phone:"",fax:"",address:"",city:"",state:"",zip:"",facility:"",country:"USA"},y={fname:"",mname:"",lname:"",email:"",phone:"",fax:"",address:"",city:"",state:"",zip:"",facility:"",country:"USA"},p=[],L=Date.now().toString()+Math.random().toString();document.querySelector("#unique-id").value=`${L}`;const $=document.querySelector('[cd="submit-data"]'),k=["Adbry","Admelog","Admelog SoloStar","Aimovig","Anoro Ellipta","Avsola","Basaglar KwikPen","Basaglar Tempo Pen","Biktarvy","Botox Cosmetic","Botox for migraines","Breo Ellipta","Cimzia","Combivent Respimat","Cosentyx","Cosentyx (300 MG Dose)","Cosentyx Sensoready Pen","Creon","Delstrigo","Dupixent","Eliquis","Emgality","Enbrel","Entyvio","Epclusa","Eucrisa","Evotaz","Fasenra","Forteo","HumaLOG","HumaLOG KwikPen","HumaLOG Mix 50/50","HumaLOG Mix 75/25","HumaLOG Mix 75/25 KwikPen","Humira","inFLIXimab","Insulin Degludec","Insulin Degludec FlexTouch","Invokana","Janumet","Janumet XR","Januvia","Jardiance","Kazano","Lantus","Linzess","Lovenox","Lyumjev","Lyumjev KwikPen","Lyumjev Tempo Pen","Motegrity","Multaq","Nesina","NovoLIN 70/30","NovoLIN 70/30 FlexPen","NovoLIN R","NovoLOG","NovoLOG FlexPen","NovoLOG Mix 70/30","NovoLOG Mix 70/30 FlexPen","Nucala","Nurtec","Ocrevus","Olumiant","Ozempic (0.25 or 0.5 MG Dose)","Ozempic (1 MG Dose)","Ozempic (2 MG Dose)","Prezcobix","Prolia","Qulipta","Remicade","Rexulti","Rinvoq","Rybelsus","Simponi","Simponi Aria","Skyrizi","Skyrizi (150 MG Dose)","Steglatro","Stelara","Stiolto Respimat","Symtuza","Taltz","Tobi Podhaler","Toujeo Max SoloStar","Toujeo SoloStar","Trelegy Ellipta","Tremfya","Tresiba","Tresiba FlexTouch","Trintellix","Ubrelvy","Viberzi","Xarelto","Xeljanz","Xeljanz XR","Zenpep","Zepatier","Zubsolv"];$.addEventListener("click",()=>{z()});async function z(){patientAddress&&patientAddress.forEach(e=>{switch(e.types[0]){case"street_number":{c.address=`${e.long_name} `;break}case"route":{c.address+=e.short_name;break}case"locality":c.city=e.long_name;break;case"administrative_area_level_1":{c.state=e.short_name;break}}}),doctorAddress&&doctorAddress.forEach(e=>{switch(e.types[0]){case"street_number":{g.address=`${e.long_name} `;break}case"route":{g.address+=e.short_name;break}case"locality":g.city=e.long_name;break;case"administrative_area_level_1":{g.state=e.short_name;break}}}),doctor2Address&&doctor2Address.forEach(e=>{switch(e.types[0]){case"street_number":{y.address=`${e.long_name} `;break}case"route":{y.address+=e.short_name;break}case"locality":y.city=e.long_name;break;case"administrative_area_level_1":{y.state=e.short_name;break}}});const n=[];document.querySelectorAll(".input-field").forEach(e=>{let t=e.id,i=e.value;(t.includes("phone")||t.includes("fax"))&&(i=i.replace(/\D/g,"")),n.push({field:t,value:i})}),document.querySelectorAll("input[type=radio]:checked").forEach(e=>{let t=e.name,i=e.id;e.name==="residency"?n.push({field:t,value:"US Citizen/Resident"}):n.push({field:t,value:i})}),n.forEach(e=>{e.field.includes("choose")&&e.value!==""&&p.push({doctor:e.value,medicationName:"",frequency:"",strength:""}),console.log(p)}),n.forEach(e=>{if(e.field.includes("doc-")){let t=e.field.split("-")[1];g[t]=e.value;return}if(e.field.includes("doc2-")){let t=e.field.split("-")[1];y[t]=e.value;return}if(e.field==="month"){c.dob=`${e.value}`;return}if(e.field==="day"||e.field==="year"){c.dob=`${c.dob}-${e.value}`;return}if(e.field==="disabled"){c[e.field]=e.value==="Yes";return}if(e.field==="ssn"){c[e.field]=e.value.replace(/-/g,"");return}if(e.field.includes("med-name-")){let t=e.field.split("-")[2];p[t-1].medicationName=e.value;return}if(e.field.includes("med-strength-")){let t=e.field.split("-")[2];p[t-1].strength=e.value;return}if(e.field.includes("frequency-")){let t=e.field.split("-")[1];p[t-1].frequency=e.value;return}c[e.field]=e.value});const l={patientData:c,doctorData:g,doctor2Data:y,drugData:p,uniqueId:L};sessionStorage.setItem("formData",JSON.stringify(l)),sessionStorage.setItem(L,JSON.stringify(l)),T(L)}const T=async n=>{const e=await(await fetch("https://voluble-axolotl-2e6e1c.netlify.app/.netlify/functions/create-stripe-session",{method:"POST",body:JSON.stringify({uniqueId:n}),headers:{"Content-Type":"application/json"}})).json();window.location.href=e.checkoutURL};function M(){const n=document.getElementById("segment-field");for(let l=1;l<5;l++){const t=document.getElementById(`med-name-${l}`).value;if(t==="")return;if(t!==k.find(i=>i===t)){if(n.value==="Brand"){n.value="Both";return}n.value="Generic";return}else{if(n.value==="Generic"){n.value="Both";return}n.value="Brand"}}}const O=document.getElementById("year"),N=105;for(let n=N;n>0;n--){const l=document.createElement("option");l.text=`${n+1900}`,l.value=`${n+1900}`,O.add(l)}function _(n,l,e,t){let i=0;l.style.display="none";const a=n.length;n.forEach((r,o)=>{o!==i&&(r.style.display="none")}),l.addEventListener("click",()=>{i===3&&(e.innerHTML="Continue"),i>0&&(n[i].style.display="none",i--,n[i].style.display="block"),t.forEach((r,o)=>{o!==i?r.classList.remove("current"):r.classList.add("current")}),i===0?l.style.display="none":l.style.display="block"}),e.addEventListener("click",()=>{const r=n[i].querySelectorAll("input"),o=n[i].querySelectorAll("select");if(F(r,o,i))if(i===3){M(),$.click();return}else i<a-1&&(n[i].style.display="none",i++,n[i].style.display="block"),t.forEach((s,d)=>{d!==i?s.classList.remove("current"):s.classList.add("current")}),i===0?l.style.display="none":l.style.display="block",i===3&&(e.innerHTML="Continue To Payment")})}const D=document.querySelectorAll("[cd-form = step]"),C=document.querySelector("[cd-form = button-back]"),P=document.querySelector("[cd-form = button-next]"),x=document.querySelectorAll("[cd-form=progress-indicator]");_(D,C,P,x);function F(n,l,e){let t=!0;n.forEach(s=>{if(s.required)if(s.value===""){if(s.id==="doc2-mname")return;t=!1,s.nextElementSibling.classList.add("active")}else{if(s.id==="doc2-mname")return;s.nextElementSibling.classList.remove("active")}}),l.forEach(s=>{s.required&&(s.value===""?(t=!1,s.nextElementSibling.classList.add("active")):s.nextElementSibling.classList.remove("active"))});const i=document.querySelectorAll("input[name=sex]:checked"),a=document.querySelectorAll("input[name=residency]:checked"),r=document.querySelectorAll("input[name=disabled]:checked");if(i.length===0?(document.getElementById("sex-radio-error").classList.add("active"),t=!1):document.getElementById("sex-radio-error").classList.remove("active"),a.length===0?(document.getElementById("citizen-radio-error").classList.add("active"),t=!1):a[0].id==="No"?(document.querySelector(".error-announcement-c").classList.add("active"),t=!1):(document.querySelector(".error-announcement-c").classList.remove("active"),document.getElementById("citizen-radio-error").classList.remove("active")),r.length===0?(document.getElementById("disabled-radio-error").classList.add("active"),t=!1):document.getElementById("disabled-radio-error").classList.remove("active"),document.getElementById("ssn").value.length!==11?(t=!1,document.getElementById("ssn-error").classList.add("active")):document.getElementById("ssn-error").classList.remove("active"),e===1){const s=document.getElementById("email");if(!s.required)return;/\S+@\S+\.\S+/.test(s.value)?s.nextElementSibling.classList.remove("active"):(t=!1,s.nextElementSibling.classList.add("active"));const v=document.getElementById("dayphone"),m=document.getElementById("EmerContactPhone");v.value.length!==16?(t=!1,v.nextElementSibling.classList.add("active")):v.nextElementSibling.classList.remove("active"),m.value.length!==16?(t=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active");const f=document.getElementById("zip");f.value.length!==5?(t=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active");const u=document.getElementById("patientAddress");B(u.value)===!1?(t=!1,u.nextElementSibling.classList.add("active")):u.nextElementSibling.classList.remove("active")}if(e===2){const s=document.getElementById("doc-email"),d=document.getElementById("doc2-email-2");for(let q=1;q<5;q++)V(document.getElementById(`med-name-${q}`));const v=/\S+@\S+\.\S+/;!v.test(s.value)&&s.value!==""?(t=!1,s.nextElementSibling.classList.add("active")):s.nextElementSibling.classList.remove("active"),d.value!==""&&(v.test(d.value)?d.nextElementSibling.classList.remove("active"):(t=!1,d.nextElementSibling.classList.add("active")));const m=document.getElementById("doc-officephone-2"),f=document.getElementById("doc-fax"),u=document.getElementById("doc2-officephone-2"),h=document.getElementById("doc2-fax-2");m.value.length!==16?(t=!1,m.nextElementSibling.classList.add("active")):m.nextElementSibling.classList.remove("active"),f.value.length!==16?(t=!1,f.nextElementSibling.classList.add("active")):f.nextElementSibling.classList.remove("active"),u.value!==""&&(u.value.length!==16?(t=!1,u.nextElementSibling.classList.add("active")):u.nextElementSibling.classList.remove("active")),h.value!==""&&(h.value.length!==16?(t=!1,h.nextElementSibling.classList.add("active")):h.nextElementSibling.classList.remove("active"));const I=document.getElementById("doctorAddress");B(I.value)===!1?(t=!1,I.nextElementSibling.classList.add("active")):I.nextElementSibling.classList.remove("active");const E=document.getElementById("doctor2Address");E.value!==""&&(B(E.value)===!1?(t=!1,E.nextElementSibling.classList.add("active")):E.nextElementSibling.classList.remove("active"));const A=document.getElementById("doc-zip-2"),b=document.getElementById("doc2-zip-2");A.value.length!==5?(t=!1,A.nextElementSibling.classList.add("active")):A.nextElementSibling.classList.remove("active"),b.value!==""&&(b.value.length!==5?(t=!1,b.nextElementSibling.classList.add("active")):b.nextElementSibling.classList.remove("active"))}return t}const S=document.querySelector(".second-doc");S.querySelectorAll(".input-field").forEach(n=>{n.addEventListener("change",()=>{n.value!==""?S.querySelectorAll(".input-field").forEach(l=>{l.name!=="doc2-email"&&(l.required=!0)}):Array.from(S.querySelectorAll(".input-field")).every(e=>e.value==="")&&S.querySelectorAll(".input-field").forEach(e=>{e.getAttribute("id")!=="doc2-mname"&&(e.required=!1,e.nextElementSibling.classList.remove("active"))})})});const G=document.querySelectorAll(".phone-field");function R(n){n.addEventListener("input",function(){this.value=this.value.replace(/\D/g,"");const l=this.value.replace(/\D/g,"").substring(0,10),e=l.substring(0,3),t=l.substring(3,6),i=l.substring(6,10);l.length>6?this.value=`(${e}) ${t} - ${i}`:l.length>3?this.value=`(${e}) ${t}`:l.length>0&&(this.value=`(${e}`)})}G.forEach(n=>{R(n)});const H=document.querySelectorAll('input[placeholder="Zip code"]');H.forEach(n=>{n.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value.length>5&&(this.value=this.value.slice(0,5))})});function j(n){return n.replace(/\D/g,"").replace(/^(\d{3})(\d{2})(\d{0,4})$/,(t,i,a,r)=>r?`${i}-${a}-${r}`:a?`${i}-${a}`:i)}const X=document.getElementById("ssn");X.addEventListener("input",function(){this.value=j(this.value)});function B(n){return/^[^,]+,\s*[^,]+,\s*[A-Z]{2},\s*USA$/.test(n)}const J=document.querySelector(".money-field");J.addEventListener("input",function(){this.value=this.value.replace(/\D/g,""),this.value!==""&&(this.value="$"+parseInt(this.value).toLocaleString())});const w=document.querySelector(".progress-bar-c"),U=document.querySelector(".progress-bar"),K={attributes:!0};function Z(n){n.forEach(function(l){if(l.type==="attributes"&&l.attributeName==="class"){let e=Array.from(x).findIndex(t=>t.classList.contains("current"));U.style.width=`${(e+1)/x.length*100}%`,window.innerWidth<768&&(e===2?w.style.transform=`translateX(-${516-window.innerWidth}px)`:e<2&&(w.style.transform="translateX(0px)"))}})}let W=new MutationObserver(Z);x.forEach(n=>{W.observe(n,K)});function Q(){let n=!1;for(let l=1;l<5;l++){const t=document.getElementById(`med-name-${l}`).value;t===k.find(i=>i===t)&&(n=!0)}n?(document.getElementById("insurance-row").classList.remove("hidden"),document.getElementById("insurance-field").required=!0,document.getElementById("brand-note").classList.remove("hidden")):(document.getElementById("insurance-row").classList.add("hidden"),document.getElementById("insurance-field").required=!1,document.getElementById("brand-note").classList.add("hidden"))}for(let n=1;n<5;n++){const l=document.getElementById(`med-name-${n}`),e=document.getElementById(`med-strength-${n}`);if(l.addEventListener("change",t=>{Q(),n!==1&&(l.value!==""?(document.getElementById(`med-strength-${n}`).required=!0,document.getElementById(`choose-doctor-${n}`).required=!0):(document.getElementById(`med-strength-${n}`).required=!1,document.getElementById(`choose-doctor-${n}`).required=!1)),e.innerHTML="";let i=t.target.value.toLocaleLowerCase().replace(/[\(\)\/.]/g,"").split(" ").join("-");if(i===""){const s=document.createElement("option");s.text="Select Medication First",s.value="",e.add(s);return}i==="ozempic-025-or-05-mg-dose"&&(i="ozempic-0-25-or-0-5-mg-dose");const a=document.querySelector(`[cd-name=${i}]`).parentElement,r=a==null?void 0:a.querySelectorAll("[cd=strength]"),o=[];r==null||r.forEach(s=>{const d={strength:s.textContent,webpapId:s.getAttribute("cd-webpap-id")};d.strength!==null&&o.push(d)}),Y(e,o)}),n!==1){const t=document.getElementById(`med-row-${n}`);t.querySelectorAll(".input-field").forEach(i=>{i.addEventListener("change",()=>{i.value!==""?t.querySelectorAll(".input-field").forEach(a=>{a.required=!0}):Array.from(t.querySelectorAll(".input-field")).every(r=>r.value==="")&&t.querySelectorAll(".input-field").forEach(r=>{r.required=!1,r.nextElementSibling.classList.remove("active")})})})}}function V(n){document.querySelectorAll("[cd=drug]").forEach(e=>{const t=document.createElement("option"),i=e.textContent,a=e.getAttribute("cd-webpap-name"),r=e.getAttribute("cd-program"),o=e.getAttribute("cd-diagnosis"),s=e.getAttribute("cd-webpap-id");i!==null&&(t.text=i,t.value=i,t.setAttribute("cd-webpap-name",a),t.setAttribute("cd-program",r),t.setAttribute("cd-diagnosis",o),t.setAttribute("cd-webpap-id",s),n.add(t))})}function Y(n,l){if(l.length>9){n.innerHTML="";const i=document.createElement("option");i.text="Select Medication First",i.value="",n.add(i);return}n.removeAttribute("disabled"),n.classList.remove("disabled"),n.innerHTML="";const e=document.createElement("option");e.text="Select Medication First",e.value="",n.add(e);let t=!0;l.forEach(i=>{if(i.strength==="")return;t=!1;const a=document.createElement("option");a.text=i.strength,a.value=i.strength,a.setAttribute("cd-webpap-id",i.webpapId),n.add(a)}),t&&(n.setAttribute("disabled","true"),n.classList.add("disabled"),n.removeAttribute("required"))}
